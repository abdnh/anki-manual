# إدارة الملفات ومجموعتك {#managing-files-and-your-collection}

<!-- toc -->

## فحص مجموعتك {#checking-your-collection}

يُنصح بفحص ملف مجموعتك من وقت لآخر للبحث عن مشاكل. تستطيع تحقيق هذا باستخدام
عنصر القائمة أدوات&gt;فحص قاعدة البيانات. يتأكد فحص قاعدة البيانات من أن الملف
غير تالف، ويعيد بناء بعض البنى الداخلية، ويعزز الملف.

يعاد بناء قائمة الوسوم أيضًا عند فحص قاعدة البيانات. عند حذف رزم أو بطاقات،
لا يحدث أنكي قائمة الوسوم المستخدمة لعدم فعالية ذلك. إذا أدرت حذف الوسوم القديمة
غير المستخدمة من قائمة الوسوم، فميزة فحص قاعدة البيانات هي طريقة تحقيق ذلك.

لاحظ أن أنكي يعزز مجموعتك تلقائيًا مرة كل أسبوعين. يتأكد هذا التعزيز من أن المجموعة
تعمل جيدًا، لكنه لا يتحقق من عدم وجود أخطاء ولا يعيد بناء قائمة الوسوم.

## مواقع الملفات {#file-locations}

في **ويندوز**، تخزن إصدارات أنكي الأخيرة ملفات أنكي الخاصة بك في مجلد appdata.
تستطيع الوصول إلى هذا المجلد بفتح مدير الملفات، وإدخال <span dir="ltr">`%APPDATA%\Anki2`</span>
في حقل الموقع. تخزن إصدارات أنكي القديمة ملفات أنكي الخاصة بك في مجلد باسم `Anki` في مجلد `مستندات`.

في حواسيب **ماك**، تخزن إصدارات أنكي الأخيرة كل ملفاتك في
مجلد <span dir="ltr">`~/Library/Application Support/Anki2`</span>.
مجلد `Library` مخفي بشكل افتراضي، لكن يمكن إظهاره في برنامج Finder بالضغط على زر option
مع الضغط على قائمة ذهاب. تخزن الإصدارات القديمة ملفاتك في مجلد `Documents/Anki`.

في **لينكس**، تخزن إصدارات أنكي الأخيرة بياناتك في مجلد <span dir="ltr">`~/.local/share/Anki2`</span>،
أو <span dir="ltr">`$XDG_DATA_HOME/Anki2`</span> إذا ضبطت مجلد بيانات مخصصًا.
تخزن الإصدارات القديمة ملفاتك في مجلد <span dir="ltr">`~/Documents/Anki`</span>
أو <span dir="ltr">`~/Anki`</span>.

في مجلد أنكي، تخزن تفضيلات البرنامج والملف الشخصي في ملف باسم prefs.db.

هناك أيضًا مجلد منفصل لكل ملف شخصي. يحتوي المجلد التالي:

- ملحوظاتك، ورزمك، وبطاقاتك، وما شابه في ملف باسم collection.anki2.

- الملفات الصوتية والصور في مجلد collection.media.

- مجلد نسخ احتياطية.

- بعض ملفات النظام

يجب ألا تنسخ مجموعتك أو تنقلها بينما يعمل أنكي. قد يسبب هذا تلف مجموعتك.
الرجاء عدم نقل الملفات الأخرى في المجلد أو تعديلها أيضًا.

## خيارات البدء {#startup-options}

إذا أجريت تعديلًا تدميريًا في جهاز وكان لديك نسخة غير معدلة في جهاز آخر، فقد ترغب
في بدء أنكي بدون مزامنة لكي تستخدم خيار المزامنة الكاملة بدون تنزيل التغييرات أولًا.
بشكل مشابه، إذا كنت تواجه مشاكل مع أنكي، فقد تريد (أو تُوجَّه إلى) إيقاف الإضافات
مؤقتًا لكي ترى إذا كانت إضافة ما تسبب المشكلة. تستطيع تحقيق كلا الأمرين عن طريق
الضغط على زر <kbd>Shift</kbd> عند بدء أنكي.

من الممكن تخصيص مكان مجلد مخصص عند بدء تشغيل أنكي. هذه الميزة متقدمة مخصصة
بشكل رئيسي لتُستخدم للتنصيب المحمول. يُنصح باستخدام الموقع الافتراضي في معظم الأحوال.

الصيغة المستخدمة لضبط مجلد بديل هي كالتالي:

<div dir="ltr">

    anki -b /مسار/مجلد/أنكي
</div>

- إذا كان لديك عدة ملفات شخصية، تستطيع استخدام <span dir="ltr">-p &lt;اسم&gt;</span>
  لتشغيل ملف محدد.

- لتغيير لغة الواجهة، استخدم <span dir="ltr">-l &lt;iso 639-1 رمز لغة&gt;</span>،
  مثل <span dir="ltr">"-l ja"</span> لاختيار اللغة اليابانية.

إذا أردت استخدام موقع مجلد مخصص دائمًا، تستطيع تعديل اختصار أنكي. في ويندوز،
اضغط بزر الفأرة الأيمن على الاختصار، واختر خصائص، واذهب إلى تبويبة اختصار، وأضف
<span dir="ltr">"-b \\مسار\\مجلد\\البيانات"</span> بعد مسار البرنامج،
لينتج نص كالتالي:

<div dir="ltr">

    "C:\Program Files\Anki\anki.exe" -b "C:\AnkiDataFolder"
</div>

تستطيع أيضًا استخدام هذه التقنية مع خيار <span dir="ltr">-l</span>
لاستخدام أنكي بلغات مختلفة بسهولة.

في ويندوز، يجب استخدام  رمز (\\) بدلًا من (/).

في ماك، ليس هناك طريقة سهلة لتغيير السلوك عند الضغط على أيقونة أنكي، لكن من الممكن
بدء أنكي في مجلد مخصص من الطرفية:

<div dir="ltr">

    open /Applications/Anki.app --args -b ~/myankifolder
</div>

كبديل، تستطيع تعريف متغير البيئة "ANKI_BASE". في ويندوز، تستطيع تعريفه كما يلي:

<div dir="ltr">

    set "ANKI_BASE=C:/مسار/مجلد/أنكي"
</div>

وفي لينكس وماك أو إس:

<div dir="ltr">

    export ANKI_BASE="/مسار/مجلد/أنكي"
</div>

## دروبوكس ومزامنة الملفات {#dropbox-and-file-syncing}

لا ينصح بمزامنة مجلد أنكي الخاص بك مع خدمة مزامنة، لأن ذلك قد يؤدي إلى تلف
قاعدة البيانات عندما تكون الملفات المزامنة قيد الاستخدام.

إذا أردت مزامنة وسائطك فقط، تستطيع ربط الملفات الخارجية مع خدمات مثل دروبوكس.
انظر [DropboxWiki: Sync
Folders Outside Dropbox (archive.org)][dropboxwiki-sync-other] لمزيد من المعلومات.

[dropboxwiki-sync-other]: http://web.archive.org/web/20180919153730/http://www.dropboxwiki.com/tips-and-tricks/sync-other-folders

إذا كنت تريد مزامنة مجموعتك أيضًا، ينصح بقوة أن تنشئ سكربت ينسخ ملفاتك من المجلد المزامن
إلى مجلد محلي، ويشغل أنكي، ثم ينسخ الملفات مجددًا عند إغلاق أنكي. يضمن هذا أن الملفات
لا تزامن أبدًا عندما يعمل أنكي.

## أنظمة ملفات الشبكة {#network-filesystems}

ننصح بقوة أن تخزن ملفات أنكي الخاصة بك على قرص صلب محلي، لأن أنظمة ملفات الشبكة
قد تؤدي إلى تلف قاعدة البيانات. إذا كان نظام ملفات الشبكة خيارك الوحيد، فينصح
باستخدام ميزة فحص قاعدة البيانات بانتظام للكشف عن الأعطال.

## التشغيل من محرك أقراص فلاش {#running-from-a-flash-drive}

في ويندوز، يمكن تنصيب أنكي على محرك أقراص فلاش وتشغيله كتطبيق محمول.
يفترض المثال التالي أن محرك أقراص الفلاش هو محرك G.

- انسخ مجلد <span dir="ltr">\\Program Files\\Anki</span> إلى محرك أقراص الفلاش،
  ليصبح لديك مجلد مثل <span dir="ltr">G:\\Anki</span>.

- أنشئ ملفًا نصيًا باسم <span dir="ltr">G:\\anki.bat</span> يحوي النص التالي:

<div dir="ltr">

    g:\anki\anki.exe -b g:\ankidata
</div>

إذا أردت منع نافذة الأوامر السوداء من البقاء مفتوحة، تستطيع استخدام التالي كبديل:

<div dir="ltr">

    start /b g:\anki\anki.exe -b g:\ankidata
</div>

- النقر نقرًا مزدوجًا على anki.bat يجب أن يبدأ أنكي بملفات المستخدم المخزنة في
  <span dir="ltr">G:\\ankidata</span>.

إن المسار الكامل، بما في ذلك حرف المحرك، مطلوب - إذا جربت استخدام
<span dir="ltr">`\anki\anki.exe`</span>، ستجد أن المزامنة تتوقف عن العمل.

قد لا تعمل مزامنة الوسائط مع أنكي ويب إذا كان محرك أقراص الفلاش الخاص بك بصيغة FAT32.
الرجاء تهيئة القرص بصيغة NTFS لضمان مزامنة الوسائط بشكل صحيح.

## النسخ الاحتياطية {#backups}

في كل مرة تُغلق فيها مجموعتك (عند إغلاق أنكي، أو تبديل الملفات الشخصية، أو مزامنة رزمتك)،
يصدّر أنكي مجموعتك إلى مجلد النسخ الاحتياطية. يخزن أنكي 30 نسخة احتياطية كحد أقصى بشكل افتراضي؛
تستطيع ضبط هذا في [التفضيلات](preferences.md).

لا تحمي النسخ الاحتياطية التلقائية من فشل القرص أو الحاسوب، ولا تشمل الوسائط.
لإبقاء مجموعاتك آمنة، يُنصح بأخذ نسخ احتياطية يدويًا أيضًا.

أسهل طريقة لإجراء نسخ احتياطي يدويًا هي باستخدام عنصر القائمة ملف&gt;تصدير لتصدير
كل رزمك مع معلومات الجدولة والوسائط، ما يحفظ كل بياناتك في ملف <span dir="ltr">.colpkg</span>.

إذا أردت نسخ عدة ملفات شخصية وإضافاتك أيضًا، تستطيع نسخ كل
[مجلد أنكي](files.md#file-locations) الخاص بك. تأكد من إغلاق أنكي أولًا،
لأن النسخ الاحتياطي قد تتلف إذا أنشئت عندما يكون أنكي مفتوحًا.

للاسترجاع من نسخة احتياطية:

1. من قائمة ملف، اختر «تبديل الملف الشخصي» لإظهار نافذة الملفات الشخصية.

2. اختر الملف الشخصي الذي تريد استرجاعه على اليسار.

3. اضغظ زر «فتح نسخة احتياطية...».

4. اختر نعم لتظهر النسخ الاحتياطية المتوفرة.

5. افتح نسخة احتياطية بناءً على التاريخ الذي تريد الاسترجاع منه.

6. تحقق من أن النسخة الاحتياطية المسترجعة هي ما تريد. إذا أدرت تجربة نسخة مختلفة،
ارجع إلى الخطوة 1.

7. أوقف أنكي المزامنة التلقائية والنسخ الاحتياطي عندما كنت تتحقق من النسخة التي اخترتها.
    بعد أن تتحق من النسخة، أغلق أنكي وافتحه مجددًا للعودة إلى السلوك الطبيعي.

يخزن أنكي أيضًا الملحوظات المحذوفة في ملف يدعى deleted.txt في مجلد ملفك الشخصي.
هذه المحلوظات بصيغة نصية يمكن أن تعالج بخيار ملف&gt;استيراد، لكن لاحظ أن ميزة الاستيراد
تدعم نوع ملحوظة واحدًا فقط في المرة الواحدة، لذلك إذا حذفت ملحوظات لها أنواع ملحوظة مختلفة،
فعليك فصل الملف إلى عدة ملفات لكل نوع ملحوظة أولًا.

## قرص صالب لا يمكن الوصول إليه {#inaccessible-harddisk}

إذا لم يكن أنكي قادرًا على الكتابة إلى الملفات في [مجلد أنكي](files.md#file-locations)
ستظهر رسالة عند البدء تخبرك بذلك، وسيُغلق أنكي. إذا لم تكن متأكدًا من كيفية
إصلاح الأذونات، الرجاء التواصل مع أحد ما بقربك لديه خبرة في الحواسيب ويمكنه مساعدتك.

## أذونات المجلد المؤقت {#permissions-of-temp-folder}

يستخدم أنكي المجلد المؤقت الخاص بالنظام لتخزين البيانات المؤقتة. إذا غُيِّرت أذونات
هذه المجلد إلى إعدادات غير الإعدادات الافتراضية من قبل برنامج ضار أو مكافح فيروسات فيه أعطال،
لن يعمل أنكي بشكل صحيح.

إذا كنت تعمل على نظام ويندوز 7، في الأسفل خطوات عامة لإصلاح المشكلة.
لأن هذا معقد بعض الشيء، الرجاء طلب المساعدة من أحد ما خبير في ويندوز إذا لم تكن متأكدًا.

1. اضغط على قائمة ابدأ، أدخل %temp% (مع علامات النسبة المئوية)، واضغط زر <kbd>Enter</kbd>.

2. ابحث عن مجلد temp في الأعلى، اضغط عليه بزر الفأرة الأيمن، واختر خصائص.

3. اضغط على «متقدم» في تبويبة الأمان.

4. اضغط على تبويبة المالك. إذا لم تظهر كمالك، اضغط على الزر لأخذ الملكية.

5. في تبويبة الأذونات، تأكد من أن لديك تحكمًا كاملًا. في تنصيب ويندوز 7 الافتراضي
    يتم توريث إعدادات التحكم من <span dir="ltr">c:\\users\\اسم-المستخدم</span>.

## مجموعات تالفة {#corrupt-collections}

يستخدم أنكي صيغة ملفات متينة ضد أعطاب البرامج والحاسوب، لكن يظل من الممكن أن تصبح
مجموعتك تالفة إذا عُدِّلت الملفات عندما يكون أنكي مفتوحًا، أو كانت المجموعة مخزنة
على قرص على الشبكة، أو بسبب عطل برمجي.

عند تشغيل أدوات&gt;فحص قاعدة البيانات، ستستلم رسالة إذا اكتشف أنكي أن الملف تالف.
**أفضل طريقة لحل هذه المشكلة هي استرجاع آخر** [نسخة احتياطية](files.md#backups)،
لكن إذا كانت هذه النسخة قديمة جدًا، فقد تجرب إصلاح التلف بدلًا من ذلك.

في لينكس، تأكد من أن sqlite3 منصب. في ماك، يجب أن يكون منصبًا بشكل افتراضي.
في ويندوز، نزّل <http://www.sqlite.org/sqlite-3_6_23.zip>.

بعد ذلك، أنشئ نسخة احتياطية لملف collection.anki2، في حال حدث خطأ عند إجراء
الخطوات في الأسفل.

### لينكس/أو إس إكس {#linuxmacos}

افتح الطرفية، اذهب إلى مجلد مجموعتك، وأدخل التالي:

<div dir="ltr">

    sqlite3 collection.anki2 .dump > dump.txt
</div>

افتح ملف dump.txt الناتج في محرر نص، وانظر إلى السطر الأخير. إذا كان يحوي
<span dir="ltr">"rollback;"</span>،
غيّره إلى <span dir="ltr">"commit;"</span>.

ثم نفّذ الأمر التالي في الطرفية:

<div dir="ltr">

    cat dump.txt | sqlite3 temp.file
</div>

تأكد من أنك تستخدم ملف temp.file - لا تضع collection.anki2 على اليمين، لأن ذلك
يفرغ الملف. انتقل إلى الخطوة الأخيرة عند الانتهاء.

### ويندوز {#windows}

انسخ برنامج `sqlite3.exe` ورزمتك إلى سطح المكتب. ثم اذهب إلى **ابدأ&gt;تشغيل**
وأدخل `cmd.exe`.

إذا كنت تعمل على إصدار حديث من ويندوز، قد لا يبدأ سطر الأوامر في سطح المكتب.
إذا لم ترى كلمة desktop في سطر الأوامر، أدخل أمرًا كالتالي، مستبدلًا «مسؤول» باسم
المستخدم الخاص بك.

<div dir="ltr">

    cd C:\Users\مسؤول\Desktop
</div>

ثم أدخل:

<div dir="ltr">

    sqlite3 collection.anki2 .dump > dump.txt
</div>

افتح ملف dump.txt الناتج في محرر نص، وانظر إلى السطر الأخير. إذا كان يحوي
<span dir="ltr">"rollback;"</span>،
غيّره إلى <span dir="ltr">"commit;"</span>.

ثم نفّذ الأمر التالي في الطرفية:

<div dir="ltr">

    type dump.txt | sqlite3 temp.file
</div>

تأكد من أنك تستخدم ملف temp.file - لا تضع collection.anki2 على اليمين، لأن ذلك
يفرغ الملف. انتقل إلى الخطوة الأخيرة عند الانتهاء.

### الخطوة الأخيرة {#final-step}

تحقق من أنك لم تحصل على رسالة خطأ، وأن ملف temp.file غير فارغ.
يعزز هذا الإجراء المجموعة أيضًا، لذلك من الطبيعي أن يكون الملف الجديد أصغر بقليل
من الملف القديم.

بعد التأكد من أن الملف غير فارغ:

- أعد تسمية ملف collection.anki2 الأصلي إلى اسم آخر.

- أعد تسمية temp.file إلى collection.anki2.

- انقل collection.anki2 إلى مجلد مجموعتك، مستبدلًا الإصدار القديم.

- ابدأ أنكي واذهب إلى أدوات&gt; فحص قاعدة البيانات للتحقق من أن المجموعة اُسترجعت بنجاح.
